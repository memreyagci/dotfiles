#!/bin/sh

pango_start="<span font=\"Font Awesome 5 Pro Solid 9\">"
pango_end="</span>"

icon_wifi="$pango_start$pango_end"
icon_ethernet="$pango_start$pango_end"
icon_wifi_disconnected="$pango_start$pango_end"
icon_ethernet_disconnected="$pango_start$pango_end"

IFS=$'\n'

LINES=$(nmcli device status)

ethernet_connections=""
wifi_connections=""

for line in $LINES; do
    echo $line > /tmp/conn

    if [ "$(awk '{print $3}' /tmp/conn)" == "connected" ]; then
        if [ "$(awk '{print $2}' /tmp/conn)" == "ethernet" ]; then
            conn_name="$(awk '{$1=$2=$3=""; print $0}' /tmp/conn | cut -d' ' -f3-)"
            ethernet_connections="$ethernet_connections$icon_ethernet$conn_name"
        elif [ "$(awk '{print $2}' /tmp/conn)" == "wifi" ]; then
            conn_name="$(awk '{$1=$2=$3=""; print $0}' /tmp/conn | cut -d' ' -f3-)"
            wifi_connections="$wifi_connections$icon_wifi$conn_name"
        fi
    fi
done

[ "$ethernet_connections" == "" ] && ethernet_connections="$icon_ethernet$icon_ethernet_disconnected"
[ "$wifi_connections" == "" ] && wifi_connections="$icon_wifi_disconnected"

echo "$ethernet_connections | $wifi_connections"
