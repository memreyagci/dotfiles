#!/bin/sh

pango_start="<span font=\"Font Awesome 5 Pro Solid 9\">"
pango_end="</span>"

icon_muted="$pango_start$pango_end"
icon_low="$pango_start$pango_end"
icon_medium="$pango_start$pango_end"
icon_high="$pango_start$pango_end"

icon_microphone="$pango_start$pango_end"
icon_microphone_off="$pango_start$pango_end"

volume=$(pactl list sinks | grep '^[[:space:]]Volume:' | \
    head -n $(( $SINK + 1 )) | tail -n 1 | sed -e 's,.* \([0-9][0-9]*\)%.*,\1,')

if [ "$(pactl list sinks | grep 'Mute: yes')" ]; then
    output="$output$icon_muted  "
elif [ $volume -ge 75 ]; then
    output="$output$icon_high $volume% "
elif [ $volume -ge 15 ]; then
    output="$output$icon_medium $volume% "
else
    output="$output$icon_low $volume% "
fi

[ "$(pactl list sources | grep -A 10 'Source #1' | grep 'Mute: no')" ] &&
    output="$output | $icon_microphone $(pactl list sources | grep -A 10 'Source #1' | grep 'Volume' | awk -F/ '{print $2}' | sed 's/ //g')" ||
    output="$output | $icon_microphone_off"

echo $output
