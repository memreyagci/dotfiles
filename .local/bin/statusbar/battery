#!/bin/sh

icon_battery="ðŸ”‹"
icon_charging="ðŸ”Œ"

hibernate () {
    notify-send "Critical battery level ($capacity%).\nHibernating the device.."
    systemctl hibernate
}

for battery in /sys/class/power_supply/BAT?
do
    capacity=$(cat "$battery"/capacity)
    status=$(cat "$battery"/status)

    if [[ $status == "Charging" || $status == "Full" || $status == "Unknown" ]]; then
        [ $capacity -ge 99 ] && printf "${icon_charging}Full" && break || printf "$icon_charging$capacity%%" && break
    elif [ $status == "Discharging" ]; then
        printf "$icon_battery$capacity%%"; 
        [[ $capacity -eq 20 || $capacity -eq 10 ]] && notify-send "Battery is low: $capacity%" && break ||
        [ $capacity -le 5 ] && hibernate && break
    fi
done
